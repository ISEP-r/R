data <- read.csv("productivity.csv")
dim(data)
#Analyse pr?liminaire : statistiques descriptives
#1

## 2
##{r}
colSums(is.na(data))
##

##There are 506 missing values in the dataset,  and only wip contains the missing values.

## 3
##{r}
data <- na.omit(data)
##Fill the missing value with mean value in that column.Remove rows with the missing values.

## 4
##{r}
summary(data$actual_productivity)

#1st Qu(1/4??????), median(?????????),mean(??????),3st QU(3/4??????)
#?????????????????????????????????????????????????????????,??????????????????????????????????????????????????????
#????????????:??????????????????????????????????????????4???????????????(Q1,Q2,Q3)
#result=quantile(data);result
##The average actual productivity is 0.722, the median actual productivity is 0.7506, the maximum value is 1.1005, the minimum value is 0.2337.

## 5

#cor????????????????????????????????????????????? ????????????
#???????????????????????????????????????????????????,???????????????cor(x,y)????????????????????????????????????
sort(abs(cor(data[, c("team", "targeted_productivity", "smv", "wip",
                      "over_time", "incentive", "idle_time", 
                      "idle_men", "no_of_style_change", "no_of_workers",
                      "actual_productivity")])["actual_productivity", ]))

#Analyse en Composantes Principales (ACP)
#6
#???????????????????????????????????????????????????????????????,???????????????????????????????????????????????????
#7
apply(data1[, c("team", "targeted_productivity", "smv", "wip",
               "over_time", "incentive", "idle_time", 
               "idle_men", "no_of_style_change", "no_of_workers",
               "actual_productivity")], 2, var)

#8
dat <- data1[, c("targeted_productivity", "smv", "over_time",
                "incentive", "no_of_workers", "actual_productivity")]
dat.pca <- prcomp(dat, center = TRUE, scale. = TRUE)
dat.pca
summary(dat.pca)
plot(dat.pca$x, main="after PCA")
biplot(dat.pca)
#9
library("factoextra")
fviz_pca_var(dat.pca, col.var = "black")
#10
d <- summary(dat.pca)
PVE <- d$importance[2,]
PVE.cum <- d$importance[3,]
barplot(PVE, ylab="Percentage of variance explained")
barplot(PVE.cum, ylab="Cumulative percentage of variance explained")












#R?gression lin?aire
#11

#12
library("openxlsx")


x=data1[,c(6)]
y=data1[,c(15)]
model=lm(y~x)
summary(model)
plot(x,y)

e=model$residuals
moyenne.e=mean(e)#??
moyenne.e


#????????0=1.08886  ????????1=-0.06468   
#13
confint(fit, level = 0.90)
#????????????????????????,???????????????????????????????????????????????????,??? 90% ?????????????????????????????? (*)
#14


#15
 # The $R^2$ is 0.4993, so 49.93% variations of the actual productivity can be explained by the financial incentive, the model is not suitable to predict the productivity.??????r???????????????


  
  
  
  
  
  




#S?lection de variables
#16
library(leaps)
leaps= data1[, c("targeted_productivity", "smv", "wip", "over_time","incentive",
                               "no_of_workers", "actual_productivity")]
models = regsubsets(actual_productivity~targeted_productivity+smv+wip+over_time
                    +incentive+no_of_workers+actual_productivity, leaps)
summary(models)
adjr2 = summary(models)$adjr2# r2
plot(adjr2, type="l") # l is forme the graphe in line
abline(v=which.max(adjr2), col="red")# v for vertical line



#17
#Gr?ce ? la fonction de regsubsets() nous avons trouver des variables ? utiliser.
#Les variables s?lectionn?es sont ?targeted_productivity?, ?smv?, ?incentive? et ?no_of_workers?.
#18
#le coefficient de d?termination ajust? tient compte au nombre de varibles.
#Parce que quand nous ajoutons une variable, le R^2 est cro?t avec des variables,
#on sait que dans un mod?le, si nous avons trop de variables, le mod?le ne sera pas stable.
#C'est pour cela nous utilisons le coefficient de d?termination ajust? plut?t que le coefficient de d?termination

#19
val = lm(actual_productivity~targeted_productivity
         +smv+incentive+no_of_workers,leaps)# lm c'est une fonction pour faire l'ajustement du mod?le de r?gression
summary(val)

#20







